# Armtek API: Правила работы с веб-сервисами (ver. 1.1.7)

**Общие рекомендации:**

1.  **Ознакомление:** Перед началом работы внимательно изучите настоящие рекомендации и документацию по конкретным веб-сервисам.

---

## 2. Необходимые понятия структуры клиента

*   **Получение структуры:** Полную структуру клиента можно получить через "Сервис получения структуры клиента" в группе "Сервисы по настройкам пользователя".

*   **Сбытовая организация (`VKORG`):**
    *   Определяет текущее место отгрузки товара (откуда товар будет отгружаться по маршруту или забираться при самовывозе).
    *   Характеризуется кодом (`VKORG`) и наименованием (`PROGRAM_NAME`).
    *   В ЭТП отображается в верхнем левом углу.
    *   Список доступных организаций можно получить через "Сервис получения сбытовых организаций клиента".

*   **Клиент:**
    *   Комплексное понятие, объединяющее набор взаимосвязанных объектов, идентифицирующих клиента и правила взаимодействия с Armtek.

*   **Структура клиента (элементы):**
    *   **Головной Клиент (`KUNAG`):**
        *   Код (`KUNAG`) и Наименование (`SNAME`) всей структуры клиента.
        *   В ЭТП отображается в черной панели.
        *   При вызове сервисов **не указывается**, определяется по логину.
    *   **Покупатель (`KUNNR_RG`):**
        *   Организация, ИП или физлицо, осуществляющее покупку и расчеты.
        *   Код (`KUNNR_RG`) и Наименование (`SNAME`).
        *   В ЭТП отображается в черной панели.
        *   Код находится в массиве `RG_TAB`, поле `KUNNR` (в ответе сервиса структуры клиента).
    *   **Грузополучатель (`KUNNR_WE`):**
        *   Подчинен Покупателю.
        *   Код (`KUNNR_WE`) и Наименование (`SNAME`).
        *   Код находится в массиве `WE_TAB`, поле `KUNNR` (в ответе сервиса структуры клиента).
    *   **Адрес доставки или Место получения (`KUNNR_ZA`):**
        *   Подчинен Покупателю. Место, куда доставляется товар (привязан маршрут доставки).
        *   Код (`KUNNR_ZA`) и Наименование (`SNAME`).
        *   Код находится в массиве `ZA_TAB`, поле `KUNNR` (в ответе сервиса структуры клиента).
    *   **Договор (`VBELN`):**
        *   Для ЮЛ и ИП основной документ взаимодействия. Подчинен Покупателю.
        *   Код (`VBELN`).
        *   Код находится в массиве `DOGOVOR_TAB`, поле `VBELN` (в ответе сервиса структуры клиента).
    *   **Контактное лицо (`PARNR`):**
        *   Подчинено Покупателю. Конкретный человек, ответственный за получение товара.
        *   Код (`PARNR`).
        *   Код находится в массиве `CONTACT_TAB`, поле `PARNR` (в ответе сервиса структуры клиента).

---

## 3. Необходимые понятия поиска и заказа

*   **Тип поиска (`QUERY_TYPE` в сервисе поиска):**
    *   Определяет, где система будет искать остатки.
    *   `1`: Поиск только на складе "Места отгрузки" (в ЭТП - зеленый индикатор).
    *   `2`: Поиск на складе "Места отгрузки" + всех доступных складах Armtek (в ЭТП - желтый индикатор).
    *   `3`: Поиск на складе "Места отгрузки" + всех складах Armtek + складах партнеров (в ЭТП - красный индикатор).

*   **Признак Самовывоза (`INCOTERMS` в сервисе создания заказа):**
    *   Сигнализирует, что клиент сам заберет товар.
    *   `1`: Самовывоз.
    *   `0` или пусто: Доставка.
    *   При `INCOTERMS=1` поле `KUNNR_ZA` заполнять **не требуется**.

*   **Артикул (`PIN`):**
    *   Искомый номер детали.

*   **Бренд (`BRAND`):**
    *   Наименование бренда искомой детали.
    *   **Важно:** Использовать только наименование бренда, принятое в Armtek.
    *   Список брендов можно получить через "Сервис получения списка брендов".

*   **Склад (`KEYZAK`):**
    *   Идентифицирует склад, с которого ищутся и заказываются запасы.
    *   В веб-сервисах поиска каждая позиция обязательно имеет `KEYZAK`.
    *   При создании заказов в структуру `ITEMS` **обязательно** транслировать значение `KEYZAK`, полученное при поиске для соответствующей позиции.

---